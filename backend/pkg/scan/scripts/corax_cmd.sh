if [ $# -ne 3 ]; then
    echo "Usage: $0 <corax_home> <workspace> <output>"
    exit 1
fi

CORAX_HOME=$1
WORKSPACE=$2
OUTPUT=$3

/usr/lib/jvm/java-17-openjdk-amd64/bin/java \
  -XX:+ExitOnOutOfMemoryError \
  -DLicence=$CORAX_HOME/bin/../lib/license/license \
  -Djava.library.path=$CORAX_HOME/bin/../lib/license/lib \
  -Dsun.stdout.encoding=UTF-8 \
  -Dsun.stderr.encoding=UTF-8 \
  -Dfile.encoding=UTF8 \
  -DCORAX_CONFIG_DEFAULT_DIR=$CORAX_HOME/bin/../lib/Plugins/Canary/analysis-config \
  -jar $CORAX_HOME/bin/../lib/Plugins/Canary/corax-cli.jar \
  --output ${OUTPUT} \
  --enable-data-flow true \
  --enable-checkers feysh.java.abuse-non-http-protocols-cookie.AndroidFileSchemeCookieEnable,feysh.java.all-object-equals.BcEqualsMethodShouldWorkForAllObjects,feysh.java.bad-exception-handling.SpringSingleConnectionFactory,feysh.java.bad-style.CharBeforeProlog,feysh.java.cipher-integrity.CipherIntegrity,feysh.java.cmdi.CommandInjection,feysh.java.codei.AviatorEvalInjection,feysh.java.codei.BeanValidation,feysh.java.codei.GroovyShell,feysh.java.codei.JavaScriptInjection,feysh.java.codei.JspSpringEval,feysh.java.codei.JxelInjection,feysh.java.codei.MVElInjection,feysh.java.codei.OgnlInjection,feysh.java.codei.ProcessControl,feysh.java.codei.ScriptEngineInjection,feysh.java.codei.SeamLogInjection,feysh.java.codei.SpringElInjection,feysh.java.config-control.BeanPropertyInjection,feysh.java.config-control.ExternalConfigControl,feysh.java.confusing-declaration.ConfusingMethodName,feysh.java.confusing-declaration.ConfusingMethodSignature,feysh.java.confusing-declaration.LocalShadowsField,feysh.java.cookie-persistent.CookiePersistent,feysh.java.cookie-persistent.PropertiesCookiePersistent,feysh.java.crlfi-log.CrlfInjectionLogs,feysh.java.csrf.SpringCsrfProtectionDisabled,feysh.java.csrf.SpringCsrfUnrestrictedRequestMapping,feysh.java.custom.PropertiesCheck,feysh.java.custom.TargetMethodInvoke,feysh.java.custom.VulnerableDependency,feysh.java.dead-code.DeadCode,feysh.java.dead-code.UnreachableBranch,feysh.java.dead-store.DeadLocalStore,feysh.java.deserial-gadget.DeserializationGadget,feysh.java.deserialization.JacksonDefaultTyping,feysh.java.deserialization.JacksonUnsafeDeserialization,feysh.java.deserialization.ObjectDeserialization,feysh.java.deserialization.RpcEnabledExtensions,feysh.java.deserialization.UnrestrictedObjectDeserialization,feysh.java.deserialization.UnsafeSpringRemoteServiceDeserialization,feysh.java.development-mode-enable.DatabaseSchemaUpdate,feysh.java.development-mode-enable.DebugFeatureEnable,feysh.java.empty-pwd.DmiEmptyDbPassword,feysh.java.empty-pwd.EmptyPassword,feysh.java.entity-leak.EntityLeak,feysh.java.entity-leak.EntityMassAssignment,feysh.java.equals-hashcode.HeEqualsUseHashcode,feysh.java.error-expose.InformationExposureThroughAnErrorMessage,feysh.java.error-expose.InformationExposureThroughUncaughtException,feysh.java.file-disclosure.InsecureDirectoryConfig,feysh.java.file-disclosure.RequestDispatcherFileDisclosure,feysh.java.file-disclosure.SpringFileDisclosure,feysh.java.file-disclosure.StrutsFileDisclosure,feysh.java.file-inclusion.JspInclude,feysh.java.file-permission-overly.OverlyPermissiveFilePermission,feysh.java.file-upload.UnrestrictedFileUpload,feysh.java.finally-return.ReturnInFinally,feysh.java.finally-throw.ThrowsExceptionInFinally,feysh.java.format-string.FormatStringManipulation,feysh.java.hardcode-credential.DmiConstantDbPassword,feysh.java.hardcode-credential.HardCodeOthers,feysh.java.hardcode-credential.HardCodePassword,feysh.java.hardcode-credential.HardCodeUserName,feysh.java.hardcode-credential.XMLHardcodedCredentials,feysh.java.hardcode-key.HardCodeKey,feysh.java.hardcode-sensitive-info.CompareWithConstant,feysh.java.hash-equals.UnsafeHashEquals,feysh.java.host-mismatch.UnSafeHostnameVerification,feysh.java.hpp.HttpParameterPollution,feysh.java.html-comment.HtmlComment,feysh.java.http-resp-split.HttpResponseSplitting,feysh.java.http-resp-split.SmtpHeaderInjection,feysh.java.httponly-cookie.HttponlyCookie,feysh.java.httponly-cookie.PropertiesHttpOnlyCookie,feysh.java.httponly-cookie.XMLHttpOnlyOnCookiesCheck,feysh.java.improper-synchronization.NotifyInsteadOfNotifyAll,feysh.java.improper-synchronization.SyncOnBoxedTypes,feysh.java.improper-synchronization.UnsafeSyncOnField,feysh.java.improper-synchronization.WaitOnConditionInterface,feysh.java.improper-verification.HasMissingJwtSignatureCheck,feysh.java.insecure-cipher.DesUsage,feysh.java.insecure-cipher.EcbMode,feysh.java.insecure-cipher.EsapiEncryptor,feysh.java.insecure-cipher.HazelcastSymmetricEncryption,feysh.java.insecure-cipher.TdesUsage,feysh.java.insecure-cookie.InsecureCookie,feysh.java.insecure-cookie.PropertiesInsecureCookie,feysh.java.instance-lock.SsdDoNotUseInstanceLockOnSharedStaticData,feysh.java.keysize-short.BlowfishKeySize,feysh.java.keysize-short.RsaKeySize,feysh.java.ldap-anonymous.LdapAnonymous,feysh.java.ldap-entry-poison.LdapEntryPoisoning,feysh.java.ldapi.LdapInjection,feysh.java.leakage.DebugLogFileLeak,feysh.java.leakage.NotMaskingPassword,feysh.java.leakage.ReturnPrivateField,feysh.java.log4j-injection.Log4jInjection,feysh.java.maven-pom.DependencyUponBintray,feysh.java.maven-pom.DependencyWithSystemScope,feysh.java.maven-pom.NonHttpsUrl,feysh.java.null-cipher.NullCipher,feysh.java.null-pointer.NullPointerDereferenceAlways,feysh.java.null-pointer.NullPointerDereferenceOnComplicatedPath,feysh.java.null-pointer.NullPointerDereferenceOnSimplePath,feysh.java.null-pointer.PassingNullToNonNullParamAlways,feysh.java.null-pointer.PassingNullToNonNullParamOnComplicatedPath,feysh.java.null-pointer.PassingNullToNonNullParamOnSimplePath,feysh.java.null-pointer.RedundantComparisonOfNullAndNonnullValue,feysh.java.null-pointer.RedundantComparisonTwoNullValues,feysh.java.null-pointer.RedundantNullCheckOfNonnullValue,feysh.java.null-pointer.RedundantNullCheckOfNullValue,feysh.java.null-pointer.RedundantNullCheckWouldHaveBeenNPE,feysh.java.null-pointer.ToStringPossibleReturnNull,feysh.java.open-redirect.UnvalidatedRedirect,feysh.java.overly-broad-cookie-attribute.OverlyBroadDomain,feysh.java.overly-broad-cookie-attribute.OverlyBroadPath,feysh.java.overly-broad-cookie-attribute.PropertiesOverlyBroadDomain,feysh.java.overly-broad-cookie-attribute.PropertiesOverlyBroadPath,feysh.java.padding-oracle.PaddingOracle,feysh.java.path-traversal.ArbitraryFileLeak,feysh.java.path-traversal.ArbitraryFileReceive,feysh.java.path-traversal.PathTraversal,feysh.java.path-traversal.PathTraversalIn,feysh.java.path-traversal.PathTraversalOut,feysh.java.path-traversal.ZipSlip,feysh.java.permission-comb.DangerousPermissionCombination,feysh.java.permissive-cors.CrossOriginResourceSharing,feysh.java.permissive-cors.PermissiveCors,feysh.java.predict-random.PredictRandom,feysh.java.predict-random.PredictableRandomSeed,feysh.java.race-condition.UnsafeDoubleCheckedLockingInitOrder,feysh.java.redos.InefficientRegularExpression,feysh.java.redos.RegularExpressionInjection,feysh.java.reflect-inject.ReflectInjection,feysh.java.resource-leak.ResourceLeakAlways,feysh.java.resource-leak.ResourceLeakOnComplicatedPath,feysh.java.resource-leak.ResourceLeakOnSimplePath,feysh.java.return-value-ignore.RrNotChecked,feysh.java.return-value-ignore.RvReturnValueIgnored,feysh.java.return-value-ignore.RvReturnValueIgnoredBadPractice,feysh.java.return-value-ignore.RvReturnValueIgnoredInferred,feysh.java.return-value-ignore.RvReturnValueIgnoredNoSideEffect,feysh.java.return-value-ignore.RvReturnValueOfPutifabsentIgnored,feysh.java.return-value-ignore.SrNotChecked,feysh.java.reverse-dns.ReverseDNSResolution,feysh.java.rsa-padding.RsaNoPadding,feysh.java.rsa-padding.RsaWithoutOAEP,feysh.java.saml-comment.SamlIgnoreComments,feysh.java.security-misconfiguration.ActuatorEndpointSecurityDisabled,feysh.java.security-misconfiguration.AntiSamyAllowExternalLinks,feysh.java.security-misconfiguration.BasicAuthentication,feysh.java.security-misconfiguration.DefaultInterceptorsLocation,feysh.java.security-misconfiguration.DefaultMessageListenerContainer,feysh.java.security-misconfiguration.SwaggerEnabled,feysh.java.security-misconfiguration.ValidationFilters,feysh.java.sensitive-data-expose.SensitiveDataExposure,feysh.java.session-persistent.ExcessiveSessionTimeout,feysh.java.session-usage.SessionFixation,feysh.java.sqli.IbatisSqlInjectionSinkHint,feysh.java.sqli.MybatisSqlInjectionSinkHint,feysh.java.sqli.SqlInjection,feysh.java.ssrf.RequestForgery,feysh.java.static-iv.StaticIv,feysh.java.string-normalize.ModificationAfterValidation,feysh.java.string-normalize.NormalizationAfterModification,feysh.java.string-normalize.NormalizationAfterValidation,feysh.java.struts-form-validation.FormNameDuplication,feysh.java.struts-form-validation.StrutsFormValidation,feysh.java.system-exit.DmExit,feysh.java.system-out-usage.InfoLeak,feysh.java.templatei.TemplateInjection,feysh.java.transaction.SqlTransaction,feysh.java.trust-boundary.TrustBoundaryViolation,feysh.java.ui-redress-attack.Clickjacking,feysh.java.unencrypted-socket.UnencryptedServerSocket,feysh.java.unencrypted-socket.UnencryptedSocket,feysh.java.unpredictable-equality.ReferenceEqualityOfBoxedTypes,feysh.java.unpredictable-equality.ReferenceEqualityOfRefTypes,feysh.java.url-rewrite.UrlRewriting,feysh.java.useless-code.UselessTypeTest,feysh.java.weak-PRNG.JHipsterGeneratorPRNG,feysh.java.weak-cert-verify.InsecureSmtpSsl,feysh.java.weak-cert-verify.WeakHostnameVerifier,feysh.java.weak-cert-verify.WeakTrustManager,feysh.java.weak-filenameutils.WeakFilenameutils,feysh.java.weak-hash.CustomMessageDigest,feysh.java.weak-hash.WeakMessageDigestMd5,feysh.java.weak-hash.WeakMessageDigestSha1,feysh.java.weak-ssl.DefaultHttpClient,feysh.java.weak-ssl.SslContext,feysh.java.xml-checker.XPathCheck,feysh.java.xml-decoder.XmlDecoder,feysh.java.xpathi.XpathInjection,feysh.java.xslti.JspXslt,feysh.java.xslti.MaliciousXslt,feysh.java.xss.CookieStoredXSS,feysh.java.xss.SpringHtmlEscapingDisabled,feysh.java.xss.XssInjection,feysh.java.xss.XssSpringResponseBody,feysh.java.xxe.XxeLocal,feysh.java.xxe.XxeRemote \
  --target java \
  --result-type SARIF \
  --auto-app-classes $WORKSPACE
